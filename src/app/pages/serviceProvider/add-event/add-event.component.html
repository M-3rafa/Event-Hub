<div class="container py-4" style="max-width: 800px;">
    <!-- Header with progress indicator -->
    <div class="text-center mb-4">
        <h2 class="fw-bold"><i class="fas fa-calendar-plus me-2"></i>Create New Event</h2>
    </div>

    <form [formGroup]="addForm" (ngSubmit)="submit()" enctype="multipart/form-data" novalidate>
        <!-- 📌 Basic Information Section -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-book text-light">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    Basic Information
                </h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label fw-bold">Event Name <span class="text-danger">*</span></label>
                    <input formControlName="name" class="form-control form-control-lg"
                        placeholder="e.g., Summer Music Festival" required />
                    <div *ngIf="addForm.get('name')?.invalid && (addForm.get('name')?.dirty || addForm.get('name')?.touched)"
                        class="text-danger small mt-1">
                        Event name is required
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Event Type <span class="text-danger">*</span></label>
                        <select formControlName="eventType" class="form-select" required>
                            <option value="">Select Event Type</option>
                            <option *ngFor="let t of eventTypes" [value]="t">{{ t }}</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Date <span class="text-danger">*</span></label>
                        <input formControlName="date" type="datetime-local" class="form-control" required />
                    </div>
                </div>

                <div class="mt-3">
                    <label class="form-label fw-bold">Description</label>
                    <textarea formControlName="description" rows="3" class="form-control"
                        placeholder="Tell attendees what to expect..."></textarea>
                </div>
            </div>
        </div>

        <!-- 📌 Conditional Event Details Sections -->
        <div *ngIf="eventType" class="card shadow-sm mb-4">
            <div class="card-header bg-light">
                <h5 class="mb-0">
                    <i class="fas fa-tasks me-2"></i>
                    Event Details
                </h5>
            </div>
            <div class="card-body">
                <!-- Match Details -->
                <div *ngIf="eventType === 'Match'" class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-bold">Stadium Name <span class="text-danger">*</span></label>
                        <input formControlName="stadiumName" class="form-control" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Team A <span class="text-danger">*</span></label>
                        <input formControlName="teamA" class="form-control" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Team B <span class="text-danger">*</span></label>
                        <input formControlName="teamB" class="form-control" />
                    </div>
                </div>

                <!-- Concert Details -->
                <div *ngIf="eventType === 'Concert'" class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-bold">Performers <span class="text-danger">*</span></label>
                        <input formControlName="performers" class="form-control"
                            placeholder="Comma separated list of performers" />
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-bold">Venue Name <span class="text-danger">*</span></label>
                        <input formControlName="placeName" class="form-control" />
                    </div>
                </div>

                <!-- Other Event Details -->
                <div *ngIf="eventType === 'Other'">
                    <label class="form-label fw-bold">Venue Name <span class="text-danger">*</span></label>
                    <input formControlName="placeName" class="form-control" />
                </div>
            </div>
        </div>

        <!-- 💳 Payment Information -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-book text-light">
                <h5 class="mb-0">
                    <i class="fas fa-credit-card me-2"></i>
                    Payment Information
                </h5>
            </div>
            <div class="card-body">
                <label class="form-label fw-bold">Stripe Payment Link</label>
                <div class="input-group">
                    <span class="input-group-text">https://</span>
                    <input formControlName="stripePaymentLink" class="form-control"
                        placeholder="pay.stripe.com/your-link" />
                </div>
                <small class="text-muted">Leave blank if payment will be handled elsewhere</small>
            </div>
        </div>

        <!-- 🗺️ Location Section -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-book text-light">
                <h5 class="mb-0 ">
                    <i class="fas fa-map-marker-alt me-2"></i>
                    Location
                </h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label fw-bold">Address</label>
                    <input formControlName="locationAddress" class="form-control"
                        placeholder="Enter address or venue name" />
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold">Select on Map <small class="text-muted">(Click to place
                            marker)</small></label>
                    <div id="eventMap" class="rounded border" style="height: 300px;"></div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Latitude</label>
                        <input formControlName="latitude" class="form-control" readonly />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Longitude</label>
                        <input formControlName="longitude" class="form-control" readonly />
                    </div>
                </div>
            </div>
        </div>

        <!-- 📄 Documents Section -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-book text-light">
                <h5 class="mb-0 ">
                    <i class="fas fa-file-alt me-2"></i>
                    Required Documents
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-6" *ngFor="let doc of [
                        { name: 'Image', label: 'Event Poster Image', required: true, icon: 'fa-image' },
                        { name: 'SecurityClearance', label: 'Security Clearance', required: true, icon: 'fa-file-shield' },
                        { name: 'PublicLicenseFront', label: 'Public License (Front)', required: true, icon: 'fa-id-card' },
                        { name: 'PublicLicenseBack', label: 'Public License (Back)', required: true, icon: 'fa-id-card' },
                        { name: 'CivilProtectionApprovalFront', label: 'Civil Protection (Front)', required: true, icon: 'fa-file-certificate' },
                        { name: 'CivilProtectionApprovalBack', label: 'Civil Protection (Back)', required: true, icon: 'fa-file-certificate' },
                        { name: 'EventInsurance', label: 'Event Insurance', required: false, icon: 'fa-file-invoice-dollar' }
                    ]">
                        <div class="document-upload">
                            <label class="form-label">
                                <i class="fas {{doc.icon}} me-1"></i>
                                {{doc.label}}
                                <span *ngIf="doc.required" class="text-danger">*</span>
                            </label>
                            <input type="file" class="form-control" (change)="onFileSelected($event, doc.name)"
                                [required]="doc.required" accept="image/*" />
                            <small *ngIf="doc.required" class="text-muted">Required</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 🎫 Ticket Types Section -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-book text-light">
                <h5 class="mb-0 ">
                    <i class="fas fa-ticket-alt me-2"></i>
                    Ticket Types
                </h5>
            </div>
            <div class="card-body">
                <div formArrayName="ticketTypes">
                    <div *ngFor="let t of ticketTypesFormArray.controls; let i = index" [formGroupName]="i"
                        class="ticket-type-card mb-3 p-3 border rounded">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Ticket Name <span class="text-danger">*</span></label>
                                <input formControlName="name" class="form-control" placeholder="VIP, General, etc." />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold">Price <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" formControlName="price" class="form-control" min="1"
                                        step="0.01" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold">Quantity <span class="text-danger">*</span></label>
                                <input type="number" formControlName="quantity" class="form-control" min="1" />
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-outline-danger" (click)="removeTicketType(i)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn btn-outline-primary mt-2" (click)="addTicketType()">
                    <i class="fas fa-plus-circle me-1"></i> Add Ticket Type
                </button>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="d-flex justify-content-between mt-4">
            <button type="button" class="btn btn-outline-secondary" routerLink="/dashboard/myevents">
                <i class="fas fa-arrow-left me-1"></i> Cancel
            </button>
            <button type="submit" class="btn btn-primary px-4" [disabled]="submitting || addForm.invalid">
                <span *ngIf="submitting" class="spinner-border spinner-border-sm me-1" role="status"
                    aria-hidden="true"></span>
                {{ submitting ? 'Creating Event...' : 'Create Event' }}
            </button>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMsg" class="alert alert-danger mt-3">
            <i class="fas fa-exclamation-triangle me-2"></i>
            {{ errorMsg }}
        </div>
    </form>
</div>