<div class="container mt-4">

    <!-- Dashboard Stats -->
    <div class="table-responsive mt-4">
        <table class="table table-bordered table-hover align-middle shadow-sm rounded">
            <thead style="background-color:#0d6efd; color:white;">
                <tr>
                    <th scope="col">Place Name</th>
                    <th scope="col">Reservations</th>
                    <th scope="col">Total Revenue (EGP)</th>
                    <th scope="col">Net Revenue After 8% Fee (EGP)</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let s of stats">
                    <td class="fw-bold">{{ s.placeName }}</td>
                    <td>{{ s.reservationsCount }}</td>
                    <td class="text-success fw-semibold">{{ s.totalRevenue | currency:'EGP' }}</td>
                    <td class="text-primary fw-semibold">{{ s.netRevenue | currency:'EGP' }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Status Tabs + Search -->
    <div class="d-flex flex-wrap align-items-center justify-content-between mb-3">
        <ul class="nav nav-tabs mb-2">
            <li class="nav-item">
                <a class="nav-link" [class.active]="selectedStatus==='All'" (click)="selectStatus('All')">All</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="selectedStatus==='Confirmed'"
                    (click)="selectStatus('Confirmed')">Confirmed</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="selectedStatus==='Pending'"
                    (click)="selectStatus('Pending')">Pending</a>
            </li>
        </ul>

        <input type="text" class="form-control w-auto flex-grow-1 ms-3" placeholder="Search by location or type..."
            [(ngModel)]="searchText" (input)="onSearchChange(searchText)" style="max-width: 300px; border: 2px solid #0d6efd; border-radius:8px;
                   box-shadow: 0 0 6px rgba(13,110,253,0.4);" />
    </div>

    <!-- Loading & Error -->
    <div *ngIf="loading" class="text-center mt-5">
        <div class="spinner-border text-primary"></div>
        <p class="mt-3 text-muted">Loading reservations...</p>
    </div>
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <!-- Reservations List -->
    <div class="row">
        <div *ngFor="let r of filteredReservations" class="col-md-4 mb-3">
            <div class="card shadow-lg border-0 rounded-3 h-100">
                <div class="card-body">
                    <h5 class="fw-bold text-primary">{{ r.placeLocation }}</h5>
                    <p><i class="bi bi-geo-alt-fill text-danger"></i> Type: <strong>{{ r.placeType }}</strong></p>
                    <p><i class="bi bi-calendar-event text-secondary"></i> Reserved Date: {{ r.reservedDate |
                        date:'medium' }}</p>
                    <p><i class="bi bi-cash-coin text-success"></i> Price: <strong>{{ r.price | currency:'EGP'
                            }}</strong></p>
                    <p>
                        <i class="bi bi-check-circle-fill"
                            [ngClass]="r.status === 'Confirmed' ? 'text-success' : 'text-warning'"></i>
                        Status: <strong [ngClass]="r.status === 'Confirmed' ? 'text-success' : 'text-warning'">
                            {{ r.status }}
                        </strong>
                    </p>
                    <p><i class="bi bi-person-circle text-info"></i> User ID: {{ r.userId }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- No Reservations -->
    <div *ngIf="!loading && filteredReservations.length === 0" class="text-center my-5">
        <p class="text-muted fs-5">No reservations found.</p>
    </div>

</div>